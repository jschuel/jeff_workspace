from chicom import chicom


def test_chicom(weights_1, weights_sq_1, N_1, is_normalized_1, weights_2, weights_sq_2, N_2, is_normalized_2,
                display_input=True):

    if display_input:
        print("\n\tINPUT")
        print("weights(1)\t\t\t" + '\t'.join(map(str, weights_1)))
        print("weights_sq(1)\t\t" + '\t'.join(map(str, weights_sq_1)))
        print("n(1)\t\t\t\t" + str(N_1))
        print("is_normalized(1)\t" + str(is_normalized_1))

        print("weights(2)\t\t\t" + '\t'.join(map(str, weights_2)))
        print("weights_sq(2)\t\t" + '\t'.join(map(str, weights_sq_2)))
        print("n(2)\t\t\t\t" + str(N_2))
        print("is_normalized(2)\t" + str(is_normalized_2))

    print("\n\tOUTPUT")
    error, stat, ndf, iters = chicom(weights_1, weights_sq_1, N_1, is_normalized_1,
                                     weights_2, weights_sq_2, N_2, is_normalized_2)
    print("stat\t\t" + str(stat))
    print("ndf\t\t\t" + str(ndf))
    print("iters\t\t" + str(iters))
    print("error\t\t" + str(error))


weights_11 = [11.0,  58.0,  234.0,  102.0,  95.]
weights_sq_11 = [11.0,  58.0,  234.0,  102.0,  95.]
weights_12 = [30.0,  119.0,  439.0,  182.0,  230.]
weights_sq_12 = [30.0,  119.0,  439.0,  182.0,  230.]
N_11 = 500
N_12 = 1000
is_normalized_11 = True
is_normalized_12 = True


weights_21 = [9.3018, 22.8871, 122.0670, 51.6786, 46.2622]
weights_sq_21 = [0.8026, 7.7173, 142.7876, 27.7087, 28.5724]
weights_22 = [68.9455, 213.5029, 898.8528, 397.7258, 419.0171]
weights_sq_22 = [108.3022, 229.3163, 3697.7102, 1455.0262,  699.6888]
N_21 = 500
N_22 = 1000
is_normalized_21 = False
is_normalized_22 = False


weights_31 = [17.0000, 53.0000, 225.0000, 101.0000, 104.0000]
weights_sq_31 = [17.0000, 53.0000, 225.0000, 101.0000, 104.0000]
weights_32 = [14.2303, 53.9921, 204.9794, 111.6337, 101.1128]
weights_sq_32 = [5.4897, 14.5935, 198.6223, 103.7259, 40.9275]
N_31 = 500
N_32 = 1000
is_normalized_31 = True
is_normalized_32 = False


weights_41 = [7.60452604, 10.283823, 10.9202585, 11.539629, 10.4362812, 10.9761066, 14.1268845, 12.9792032, 13.278697, 13.3303699, 13.4807529, 13.6546144, 14.867074, 16.9011078, 18.9638424, 16.1622734, 18.564085, 15.4853792, 23.6959591, 23.2526875, 28.6932716, 24.3378963, 22.9038658, 27.6368656, 32.7615547, 34.0868149, 30.2832451, 41.2441788, 38.7611275, 40.1070023, 47.2988853, 59.6162224, 55.7204781, 71.4916534, 80.6377945, 76.6624603, 93.0035324, 82.7233887, 106.975441, 108.767769, 144.613068, 177.319366, 179.3423, 187.743652, 207.915527, 254.759949, 221.778198, 281.57724, 305.309479, 287.657562, 333.075745, 283.301971, 253.126175, 265.176666, 198.045547, 180.94136, 198.809982, 197.135498, 150.509598, 156.650726, 151.623032, 118.613579, 119.983437, 105.956505, 88.010849, 80.0103226, 77.6998138, 78.9442902, 85.3383408, 98.4942703, 83.276268, 103.32666, 84.2896347, 99.4223862, 85.2626114, 107.484985, 107.829971, 110.368942, 146.976486, 148.026886, 153.036545, 133.023819, 157.984772, 150.08844, 142.037766, 158.664719, 130.893707, 153.17395, 120.494179, 107.994171, 98.6770096, 89.7603989, 91.5290222, 68.9894943, 65.337471, 59.0607872, 49.923111, 46.7646103, 46.2952271, 34.1213493]
weights_sq_41 = [0.722930968, 1.01701725, 1.12515104, 1.2331425, 1.15880656, 1.26830375, 1.70597279, 1.63576698, 1.74605715, 1.83219802, 1.93368042, 2.04926515, 2.35192752, 2.80099463, 3.30003953, 2.96895266, 3.59053874, 3.15597701, 5.10594988, 5.30207825, 6.92025852, 6.23714876, 6.24722528, 8.04230213, 10.2263641, 11.3961382, 10.7949076, 15.9046326, 16.1636143, 18.0838165, 23.0769882, 31.751564, 32.3623161, 45.2665634, 56.101078, 58.8218765, 79.4329987, 78.7375031, 113.408127, 128.699387, 192.076508, 264.499817, 300.963318, 352.875122, 441.535492, 595.929993, 565.688354, 777.584656, 887.865479, 861.966675, 999.46698, 827.545776, 704.299377, 689.766541, 472.900787, 390.037018, 387.877625, 344.196869, 238.652435, 223.256851, 198.299377, 142.200195, 132.13559, 109.042343, 85.1409988, 73.594162, 68.6112137, 67.7439651, 72.1057816, 82.9156036, 70.7659378, 89.7228317, 75.5925369, 93.2757492, 84.5577621, 114.427742, 122.438522, 135.41478, 194.693115, 210.772827, 231.942352, 210.687363, 257.315186, 244.856171, 226.7052, 242.126877, 186.317459, 200.658218, 143.867447, 115.580666, 94.6351395, 77.5404587, 70.4646149, 47.6438904, 40.6928825, 33.5666428, 25.4503269, 21.6677437, 19.6757717, 13.2383814]
N_41 = 10000
is_normalized_41 = True
weights_42 = [943.896851, 985.421997, 1039.92627, 1080.15735, 1120.75293, 1142.63538, 1206.45667, 1251.36865, 1317.52661, 1385.26941, 1469.72803, 1504.06299, 1609.25659, 1656.02356, 1740.99792, 1835.3844, 1950.4729, 2040.66724, 2150.77612, 2299.22925, 2414.28784, 2557.62012, 2757.39404, 2935.68335, 3166.10767, 3355.80688, 3620.42407, 3916.7334, 4187.95947, 4520.28076, 4855.12695, 5292.74463, 5663.57617, 6340.3125, 6916.29492, 7640.71777, 8478.2041, 9387.03223, 10540.5576, 11864.8516, 13214.0518, 14854.0322, 16613.3438, 18850.9492, 20935.6797, 22993.127, 25473.1035, 27668.1348, 29156.8125, 30343.6172, 30157.2949, 29499.9961, 28050.3574, 25891.5312, 23616.5195, 21322.3613, 19376.5859, 17483.373, 15782.3877, 14251.085, 13063.7275, 11896.1318, 10947.1104, 10108.7188, 9593.73242, 9135.76367, 8685.1582, 8588.52832, 8439.20117, 8429.07422, 8318.34961, 8577.33203, 9062.00098, 9398.84766, 9765.9082, 10715.0703, 11292.9688, 12152.2363, 13332.1602, 14207.3203, 15087.3613, 15844.6621, 16163.8652, 16490.6289, 15938.4746, 15375.8018, 14443.7637, 13071.2373, 11885.6582, 10689.3301, 9468.86621, 8632.13965, 7757.55713, 6901.77002, 6233.3335, 5670.30078, 5090.0498, 4671.73584, 4311.8208, 3850.32764]
weights_sq_42 = [89.9771347, 97.5166245, 106.87558, 115.429955, 124.6035, 132.286362, 145.560181, 157.450195, 173.148361, 190.254379, 211.13002, 226.308731, 253.867081, 274.186371, 302.96051, 336.164978, 376.494171, 415.790771, 463.027802, 524.128418, 583.459106, 656.647827, 753.646179, 855.63092, 985.265015, 1118.99707, 1296.15735, 1508.9939, 1740.16614, 2033.19348, 2369.24268, 2810.06494, 3285.60718, 4027.29419, 4830.73096, 5888.91553, 7240.08838, 8906.50488, 11147.2598, 14054.6299, 17549.4688, 22174.0234, 27868.6816, 35509.8594, 44071.6992, 53695.0156, 65180.793, 76328.2344, 84896.8516, 90920.5078, 90516.3984, 86328.0469, 78074.4141, 67153.7812, 56202.1641, 46064.7422, 37764.3477, 30704.7305, 25014.7598, 20439.9746, 17043.6641, 14212.4756, 12080.2256, 10391.7109, 9274.98828, 8394.62891, 7671.27881, 7375.87939, 7132.03857, 7097.33789, 7066.61621, 7443.84961, 8133.37598, 8827.81738, 9701.25391, 11361.9248, 12865.8135, 14933.2764, 17678.834, 20231.0527, 22848.4668, 25133.2559, 26311.6289, 26903.2695, 25423.9648, 23416.0762, 20572.2129, 17104.6562, 14133.1221, 11453.0029, 9098.86914, 7438.06201, 5985.58887, 4783.25146, 3885.42529, 3191.76025, 2596.23218, 2168.48633, 1827.16589, 1494.77539]
N_42 = 1000000
is_normalized_42 = True


print("\n\nTest 1:")
test_chicom(weights_11, weights_sq_11, N_11, is_normalized_11, weights_12, weights_sq_12, N_12, is_normalized_12)


print("\n\nTest 2:")
test_chicom(weights_21, weights_sq_21, N_21, is_normalized_21, weights_22, weights_sq_22, N_22, is_normalized_22)


print("\n\nTest 3:")
test_chicom(weights_31, weights_sq_31, N_31, is_normalized_31, weights_32, weights_sq_32, N_32, is_normalized_32)


print("\n\nTest 4:")
test_chicom(weights_41, weights_sq_41, N_41, is_normalized_41, weights_42, weights_sq_42, N_42, is_normalized_42, display_input=False)
